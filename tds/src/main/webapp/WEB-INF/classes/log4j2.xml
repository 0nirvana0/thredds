<?xml version="1.0" encoding="UTF-8"?>
<configuration monitorInterval="30">
  <appenders>

    <File name="serverStartupAppender" fileName="${tds.log.dir}/serverStartup.log" append="false">
      <PatternLayout pattern="%d{yyyy-MM-dd'T'HH:mm:ss.SSSZ} [%10r][%8X{ID}] %-5p %c: %m%n"/>
    </File>

    <File name="catalogInit" fileName="${tds.log.dir}/catalogInit.log" append="false">
      <PatternLayout pattern="%m%n"/>
    </File>

    <RollingFile name="fcScan" fileName="${tds.log.dir}/featureCollectionScan.log" filePattern="${tds.log.dir}/featureCollectionScan.%i.log">
      <PatternLayout pattern="[%d{yyyy-MM-dd'T'HH:mm:ss.SSSZ}] %-5p %c: %m%n"/>
      <Policies>
        <SizeBasedTriggeringPolicy size="1 MB"/>
      </Policies>
      <DefaultRolloverStrategy max="10"/>
    </RollingFile>

    <RollingFile name="fc" fileName="${tds.log.dir}/fc.log" filePattern="${tds.log.dir}/fc.%i.log">
      <PatternLayout pattern="%d{yyyy-MM-dd'T'HH:mm:ss.SSS Z} %-5p - %m%n"/>
      <Policies>
        <SizeBasedTriggeringPolicy size="1 MB"/>
      </Policies>
      <DefaultRolloverStrategy max="10"/>
    </RollingFile>

    <RollingFile name="threddsServlet" fileName="${tds.log.dir}/threddsServlet.log" filePattern="${tds.log.dir}/threddsServlet.$${date:yyyy-MM-dd-HH}.log">
      <PatternLayout pattern="%d{yyyy-MM-dd'T'HH:mm:ss.SSS Z} [%10r][%8X{ID}] %-5p - %c - %m%n"/>
      <Policies>
        <TimeBasedTriggeringPolicy/>
        <SizeBasedTriggeringPolicy size="100 MB"/>
      </Policies>
    </RollingFile>

    <RollingFile name="cacheLog" fileName="${tds.log.dir}/cache.log" filePattern="${tds.log.dir}/cache.%i.log">
      <PatternLayout pattern="[%d{yyyy-MM-dd'T'HH:mm:ss.SSSZ}] %m%n"/>
      <Policies>
        <SizeBasedTriggeringPolicy size="1 MB"/>
      </Policies>
      <DefaultRolloverStrategy max="3"/>
    </RollingFile>

    <Console name="consoleLogger" target="SYSTEM_OUT">
      <PatternLayout pattern="%d{yyyy-MM-dd'T'HH:mm:ss.SSS Z} %-5p - %c - %m%n"/>
    </Console>

  </appenders>

  <loggers>
    <logger name="cacheLogger" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="cacheLog"/>
    </logger>

    <logger name="thredds.filesystem.CacheManager" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="cacheLog"/>
    </logger>

    <logger name="thredds.servlet.DataRootHandler.catalogInit" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="catalogInit"/>
    </logger>

    <logger name="thredds.catalog.parser" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="catalogInit"/>
    </logger>

    <logger name="thredds.featurecollection.FeatureCollectionConfig" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="catalogInit"/>
    </logger>

    <logger name="serverStartup" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="serverStartupAppender"/>
    </logger>

    <!-- featureCollection debugging -->
    <logger name="thredds.inventory.MFileCollectionManager" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="thredds.inventory.CollectionUpdater" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="thredds.server.root.CollectionController" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="ucar.nc2.grib" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="ucar.nc2.grib.grib1.Grib1CollectionBuilder" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="ucar.nc2.grib.grib2.Grib2CollectionBuilder" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="thredds.catalog.InvDatasetFeatureCollection" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="thredds.catalog.InvDatasetFcGrib" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="org.quartz" additivity="false">
      <level value="WARN"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <!-- fmrc debugging -->

    <logger name="thredds.inventory.bdb.MetadataManager" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="ucar.nc2.ft.fmrc.Fmrc" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="ucar.nc2.ft.fmrc.FmrcInv" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="ucar.nc2.ft.fmrc.FmrcInvLite" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="ucar.nc2.ft.fmrc.FmrcDataset" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="ucar.nc2.ft.fmrc.GridDatasetInv" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <logger name="thredds.servlet.DataRootHandler.fcScan" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="fcScan"/>
    </logger>

    <!-- end fmrc debugging -->

    <!-- All normal logging messages go to threddsServlet.log -->
    <logger name="opendap" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="threddsServlet"/>
    </logger>

    <logger name="thredds" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="threddsServlet"/>
    </logger>

    <!-- WMS stuff has routine higher level of messages -->
    <logger name="uk.ac.rdg.resc.ncwms" additivity="false">
      <level value="WARN"/>
      <appender-ref ref="threddsServlet"/>
    </logger>

    <logger name="thredds.server.wms.responses" additivity="false">
      <level value="WARN"/>
      <appender-ref ref="threddsServlet"/>
    </logger>

    <logger name="thredds.server.wms" additivity="false">
      <level value="INFO"/>
      <appender-ref ref="threddsServlet"/>
    </logger>

    <logger name="thredds.server.metadata" additivity="false">
      <level value="WARN"/>
      <appender-ref ref="threddsServlet"/>
    </logger>

    <logger name="org.springframework.beans.factory" additivity="false">
      <level value="ERROR"/>
      <appender-ref ref="serverStartupAppender"/>
    </logger>

    <logger name="org.apache.log4j.xml" level="debug">
      <appender-ref ref="A1"/>
    </logger>

    <root>
      <level value="INFO"/>
      <appender-ref ref="threddsServlet"/>
    </root>

  </loggers>

</configuration>