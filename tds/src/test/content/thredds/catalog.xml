<?xml version="1.0" encoding="UTF-8"?>
<catalog name="TDS Unit Test Server"
         xmlns="http://www.unidata.ucar.edu/namespaces/thredds/InvCatalog/v1.0"
         xmlns:xlink="http://www.w3.org/1999/xlink">

  <service name="latest" serviceType="Resolver" base=""/>

  <service name="all" base="" serviceType="compound">
    <service name="odap" serviceType="OpenDAP" base="/thredds/dodsC/"/>
    <service name="http" serviceType="HTTPServer" base="/thredds/fileServer/"/>
    <service name="wcs" serviceType="WCS" base="/thredds/wcs/"/>
    <service name="wms" serviceType="WMS" base="/thredds/wms/"/>
    <service name="ncss" serviceType="NetcdfSubset" base="/thredds/ncss/"/>
    <service name="cdmremote" serviceType="CdmRemote" base="/thredds/cdmremote/"/>
    <service name="iso" serviceType="ISO" base="/thredds/iso/"/>
    <service name="ncml" serviceType="NCML" base="/thredds/ncml/"/>
    <service name="uddc" serviceType="UDDC" base="/thredds/uddc/"/>   
  </service>

  <datasetRoot path="localContent" location="content/testdata/"/>
  <datasetRoot path="cdmUnitTest" location="${cdmUnitTest}"/>

  <dataset name="Test Single Dataset" ID="testDataset" serviceName="odap" urlPath="localContent/testData.nc" dataType="Grid"/>
  <dataset name="Test Single Dataset 2" ID="testDataset2" serviceName="odap" urlPath="localContent/2004050412_eta_211.nc" dataType="Grid"/>
  <dataset name="Test latlon crossing seam" ID="testCrossingSeam" serviceName="all" urlPath="localContent/GFS_Global_onedeg_20120515_1200.grib2.nc" dataType="Grid"  />
  <dataset name="Test climatology" ID="testClimatology" serviceName="all" urlPath="cdmUnitTest/ncss/climatology/PF5_SST_Climatology_Monthly_1985_2001.nc" dataType="Grid"  />

  <dataset name="Test Single Grid Dataset" ID="testSingleGridDataset" serviceName="all" urlPath="cdmUnitTest/ncss/CONUS_80km_nc/GFS_CONUS_80km_20120419_0000.nc" dataType="Grid"/>
  <dataset name="Test Single Station Dataset" ID="testSingleStationDataset" serviceName="all" urlPath="cdmUnitTest/ncss/point_features/metar/Surface_METAR_20130826_0000.nc" dataType="Station"/>
  <dataset name="Test sst" ID="TESTsst" serviceName="all" urlPath="cdmUnitTest/conventions/coards/sst.mnmean.nc" dataType="Grid"/>

  <datasetScan name="Test Scan Local" ID="testScanLocal" path="scanLocal" location="content/testdata/">
     <metadata inherited="true">
       <serviceName>all</serviceName>
     </metadata>
    <sort>
      <lexigraphicByName increasing="true" />
    </sort>
   </datasetScan>

  <!-- a scan on the entire /upc/share/cdmUnitTest directory; not all services will make sense -->
  <datasetScan name="Test scan cdmUnitTest" ID="scanCdmUnitTests" path="scanCdmUnitTests" location="${cdmUnitTest}/">
    <metadata inherited="true">
      <serviceName>all</serviceName>
    </metadata>
    <sort>
      <lexigraphicByName increasing="true" />
    </sort>
    <addDatasetSize/>
  </datasetScan>

  <datasetScan name="Test Scan Grids" ID="testGridScan" path="testGridScan" location="${cdmUnitTest}/ncss/GFS/CONUS_80km">
     <metadata inherited="true">
       <serviceName>all</serviceName>
       <dataType>Grid</dataType>
       <dataFormat>GRIB-1</dataFormat>
     </metadata>
   </datasetScan>

  <!-- Test Dataset Scan on Station data-->
 <!-- pathInfo:   /testTdsScan/GFS_CONUS_80km_yyyyMMdd_HHmm.grib1.nc -->
 <datasetScan name="Test Scan Stations" ID="testStationScan" path="testStationScan" location="${cdmUnitTest}/ncss/point_features/metar">
   <metadata inherited="true">
     <serviceName>all</serviceName>
     <dataType>Station</dataType>
   </metadata>
 </datasetScan>

  <!-- opendap specific -->
  <!--
  <datasetScan name="opendapTest" ID="opendapTest" path="opendapTest" location="${cdmUnitTest}/tds/opendap">
    <metadata inherited="true">
      <serviceName>all</serviceName>
    </metadata>
  </datasetScan>
 -->
  <!--
  <catalogRef xlink:title="Test Enhanced Catalog" xlink:href="enhancedCatalog.xml" name=""/>

  <dataset name="Test Restricted Dataset" ID="testRestrictedDataset" urlPath="testStandardTds/testData2.grib2" restrictAccess="tiggeData">
    <serviceName>odap</serviceName>
    <dataType>Grid</dataType>
  </dataset>
  -->
  <!-- test NcML in dataset -->
  <!--
  <dataset name="Example NcML Modified - DODS" ID="ExampleNcMLModified" urlPath="ExampleNcML/Modified.nc">
    <serviceName>odap</serviceName>
    <dataType>Grid</dataType>
    <netcdf xmlns="http://www.unidata.ucar.edu/namespaces/netcdf/ncml-2.2" location="/share/testdata/cdmUnitTest/tds/example1.nc"
            addRecords="true">
      <attribute name="name" value="value"/>
      <variable name="Temperature" orgName="T"/>
      <variable name="ReletiveHumidity" orgName="rh">
        <attribute name="long_name" value="relatively humid"/>
        <attribute name="units" value="percent (%)"/>
        <remove type="attribute" name="description"/>
      </variable>
    </netcdf>
  </dataset>
  -->
  <!-- test NcML in dataset -->
  <!--
  <dataset name="Example NcML Modified - cdmremote" ID="ExampleNcMLModified2" urlPath="ExampleNcML2/Modified.nc">
    <serviceName>cdmremote</serviceName>
    <dataType>Grid</dataType>
    <netcdf xmlns="http://www.unidata.ucar.edu/namespaces/netcdf/ncml-2.2" location="/share/testdata/cdmUnitTest/tds/example1.nc"
            addRecords="true">
      <attribute name="name" value="value"/>
      <variable name="Temperature" orgName="T"/>
      <variable name="ReletiveHumidity" orgName="rh">
        <attribute name="long_name" value="relatively humid"/>
        <attribute name="units" value="percent (%)"/>
        <remove type="attribute" name="description"/>
      </variable>
    </netcdf>
  </dataset>
  -->
  <!-- test NcML in datasetScan -->
  <!--
  <datasetScan name="ModifyDatasetScan" ID="ModifyDatasetScan" path="ModifyDatasetScan" location="/share/testdata/cdmUnitTest/tds/">
    <metadata inherited="true">
      <serviceName>all</serviceName>
      <dataType>Grid</dataType>
    </metadata>

    <filter>
      <include wildcard="*.nc" collection="false"/>
      <exclude wildcard="/*" collection="true"/>
    </filter>

    <netcdf xmlns="http://www.unidata.ucar.edu/namespaces/netcdf/ncml-2.2" addRecords="true">
      <attribute name="name" value="value"/>
      <variable name="Temperature" orgName="T"/>
      <variable name="ReletiveHumidity" orgName="rh">
        <attribute name="long_name" value="relatively humid"/>
        <attribute name="units" value="percent (%)"/>
        <remove type="attribute" name="description"/>
      </variable>
    </netcdf>

  </datasetScan>
  -->
  <!-- test NcML aggregation in dataset -->
  <!--
  <dataset name="Example NcML Aggregation" ID="ExampleNcMLAgg" urlPath="ExampleNcML/Agg.nc">
    <serviceName>odap</serviceName>
    <dataType>Grid</dataType>
    <netcdf xmlns="http://www.unidata.ucar.edu/namespaces/netcdf/ncml-2.2">
      <aggregation dimName="time" type="joinExisting" timeUnitsChange="true">
        <netcdf location="/share/testdata/cdmUnitTest/ncml/nc/namExtract/20060925_0600.nc" ncoords="2"/>
        <netcdf location="/share/testdata/cdmUnitTest/ncml/nc/namExtract/20060925_1200.nc" ncoords="2"/>
        <netcdf location="/share/testdata/cdmUnitTest/ncml/nc/namExtract/20060925_1800.nc" ncoords="2"/>
        <netcdf location="/share/testdata/cdmUnitTest/ncml/nc/namExtract/20060926_0000.nc" ncoords="2"/>
      </aggregation>
      <attribute name="ncmlAdded" value="stuff"/>
      <variable name="lat">
        <attribute name="ncmlAdded" value="lat_stuff"/>
      </variable>
    </netcdf>
  </dataset>
  -->

  <!-- test FMRC -->
  <featureCollection featureType="FMRC" name="GFS_CONUS_80km_FMRC" path="testGFSfmrc">

    <metadata inherited="true">
      <serviceName>all</serviceName>
      <dataType>Grid</dataType>
    </metadata>

    <collection spec="${cdmUnitTest}/ncss/CONUS_80km_nc/GFS_CONUS_80km_#yyyyMMdd_HHmm#.nc$" />
    <update startup="true" rescan="* * 0/2 * * ? *" trigger="allow"/>
    <fmrcConfig regularize="true" datasetTypes="TwoD Best Files Runs ConstantForecasts ConstantOffsets"/>
  </featureCollection>

  <featureCollection featureType="FMRC" name="NAM FMRC" path="testNAMfmrc">

    <metadata inherited="true">
      <serviceName>all</serviceName>
      <dataType>Grid</dataType>
    </metadata>

    <collection spec="${cdmUnitTest}/ncml/agg/#yyyyMMdd_HHmm#.nc$" />
    <update startup="true" rescan="10 43 * * * ? *" trigger="allow"/>

    <protoDataset choice="Penultimate" change="0 43 * * * ? *">
      
      <netcdf xmlns="http://www.unidata.ucar.edu/namespaces/netcdf/ncml-2.2">
        <attribute name="ncmlAdded" value="goodStuff"/>
        <variable name="Visibility">
          <attribute name="ncmlAdded" value="reallyGoodStuff"/>
        </variable>
      </netcdf>
    </protoDataset>

    
    <netcdf xmlns="http://www.unidata.ucar.edu/namespaces/netcdf/ncml-2.2">
      <variable name="Visibility">
        <attribute name="ncmlInnerAdded" value="innerTruth"/>
      </variable>
    </netcdf>

    <fmrcConfig regularize="true" datasetTypes="TwoD Best Files Runs ConstantForecasts ConstantOffsets"/>

  </featureCollection>

  <!-- LOOK original dataset lost ?? -->
  <featureCollection name="POLCOMS-Irish-Sea" featureType="FMRC" path="NCOF/POLCOMS/IRISH_SEA">

    <metadata inherited="true">
      <serviceName>all</serviceName>
      <dataType>Grid</dataType>
    </metadata>

    <collection spec="${cdmUnitTest}/ncml/agg/#yyyyMMdd_HHmm#.nc$"/>

    <protoDataset>
      <netcdf xmlns="http://www.unidata.ucar.edu/namespaces/netcdf/ncml-2.2">
        <variable name="Visibility">
          <attribute name="units" value="celsius"/>
        </variable>
      </netcdf>
    </protoDataset>

  </featureCollection>

  <!-- featureCollection station -->
  <featureCollection name="Metar Station Data" harvest="true" featureType="Station" path="testStationFeatureCollection">
    <metadata inherited="true">
      <dataType>Station</dataType>
      <documentation type="summary">Metars: hourly surface weather observations</documentation>
      <keyword>metar</keyword>
      <keyword>surface observations</keyword>
    </metadata>

    <property name="raw" value="report"/>
    <property name="resolution" value="20 min"/>

    <collection spec="${cdmUnitTest}/ft/station/ldm-metar/Surface_METAR_#yyyyMMdd_HHmm#.nc$" />
    <update startup="true" rescan="0 0/15 * * * ? *" trigger="allow"/>
    <protoDataset choice="Penultimate" />
    <pointConfig datasetTypes="cdmrFeature Files"/>
  </featureCollection>

  <!--
  <catalogRef xlink:title="Test FMRC with inner and outer NcML" xlink:href="wav_mod.xml" name=""/>
  -->
  <!-- datasetScan name="NCSS testing dataset" ID="ncssTestDataset" serviceName="all" path="ncssTest" location="${ncss}/test">
    <metadata inherited="true">
      <serviceName>all</serviceName>
      <dataType>Grid</dataType>
    </metadata>
  </datasetScan>

  <datasetScan name="ncWMS Dataset" ID="ncWMSTestDataset" serviceName="all" path="ncWMSTest" location="${testdata}/ncwms">
    <metadata inherited="true">
      <serviceName>all</serviceName>
      <dataType>Grid</dataType>
    </metadata>
  </datasetScan -->

  <catalogRef xlink:title="Test NCSS" xlink:href="ncss_test_catalog.xml" name=""/>

</catalog>
