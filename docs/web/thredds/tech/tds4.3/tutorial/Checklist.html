<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
 <html>
  <head>
   <title>TDS Installation Checklist for Production</title>
   <link rel="stylesheet" href="tutorial2.css" type="text/css" /> 
   <script type="text/javascript" src="workshopNav.js"></script>
  </head>
  <body>
   <h1>TDS Installation Checklist for Production Security</h1>

   <div id="section">
    <h2><a name="install">Initial Installation</a></h2>

    <h3>Install Java</h3>
    <ol>
     <li><a href="GettingStarted.html#install">Download and install</a> the latest version of JDK 1.7</li>
    </ol>

    <h3>Tomcat Install</h3>
    <ol>
     <li>Create a <a href="Security.html#install">dedicated user and group for running Tomcat</a> who does not have root privileges. <a href="Security.html#install">Modify the permissions</a> in <code>${tomcat_home}</code> to allow this user access to only the necessary parts of the Tomcat installation.</li>
     <li><a href="GettingStarted.html#installTomcat">Download and install</a> the latest version of Tomcat 7.</li>
     <li>In <code>${tomcat_home}/bin</code> <a href="GettingStarted.html#makeSetenv">create a <code>setenv.sh</code></a> shell script, and set the values of <code>$JAVA_HOME</code>, <code>$JAVA_OPTS</code> and <code>$CATALINA_BASE</code>.</li>
     <li>Purchase a real certificate from a <a href="http://en.wikipedia.org/wiki/Certificate_authority">certificate authority</a>, so users are not confused and question the legitimacy of your web site.  <!-- (Otherwise, <a href="BasicTomcatAndTDSSecurity.html#createCert">create a self-signed certificate</a>).--> </li>
     <li>Make the following modifications to <code>${tomcat_home}/conf/server.xml</code>:</li>
      <ul>
       <li><a href="Security.html#useDigest">Enable digest passwords</a> by commenting out the <code>UserDatabaseRealm</code> and enabling the <code>MemoryRealm</code>.</li>
       <li><a href="Security.html#enableSSL">Enable SSL</a> by uncommenting the <code>SSL Connector</code> listening on port 8443, and add the required <code>keystoreFile</code> and <code>keystorePass</code> attributes.</li>
       <li><a href="../reference/Performance.html#enableCompression">Enable compression</a> by adding <code>compression</code> and <code>compressableMimeType</code> attributes to 8080 Connector.</li>
       <li><a href="TDSMonitoringAndDebugging.html#access">Enable access logging</a> by uncommenting the <code>AccessLogValve</code> and change the <code>prefix</code> and <code>suffix</code> and <code>pattern</code> attributes.</li>
      </ul>
     <li><a href="Security.html#makeDigest">Create a password digest</a> using the <code>${tomcat_home}/bin/digest.sh</code> script.</li>
     <li>Make the following modifications to  <code>${tomcat_home}/conf/tomcat-users.xml</code>:</li>
      <ul>
       <li>Define the roles <code><a href="GettingStarted.html#grantingAccess">manager-gui</a></code> and <code><a href="Security.html#grantingAccess">tdsConfig</a></code>.</li>
       <li><a href="Security.html#grantAccess">Add yourself as a user</a> with the roles <code>manager-gui</code> and <code>tdsConfig</code> using your digest password your created in step #6 above.</li>
      </ul>
     <li>Make the following modifications to <code>${tomcat_home}/webapps/manager/WEB-INF/web.xml</code>:</li>
     <ol>
      <li>Make sure the manager is only <a href="Security.html#managerSSL">available via SSL</a> by adding a <code>user-data-constraint</code> with a <code>transport-guarantee</code> of <code>CONFIDENTIAL</code> inside the <code>security-constraint</code> element.</li>
     </ol>
     <li><a href="Security.html#unused">Remove any unused applications</a> from <code>${tomcat_home}/webapps</code>.</li>
    </ol>

    <h3>TDS Install</h3>
    <ol>
     <li><a href="GettingStarted.html#deploying">Download</a> the latest <code>thredds.war</code> file, and put it into <code>${tomcat_home}/webapps</code>.</li>
     <li>Start/restart Tomcat so that it has a chance to create initial files in <code>${tomcat_home}/content/thredds</code>.</li>
     <li>Modify <code>${tomcat_home}/content/thredds/catalog.xml</code> for your site, as in this <a href="BasicConfigCatalogs.html#exampleCatalog">example</a>.</li>
     <li>Modify <code> ${tomcat_home}/content/thredds/threddsConfig.xml</code> for your site in the following manner:</li>
     <ul>
      <li><a href="BasicThreddsConfig_xml.html#serverInfo">Add the needed information to the <code>serverInformation</code></a></li>
      <li><a href="AddingServices.html">Enable any other optional services</a> like WMS or WCS.</li>
     </ul>
     <li>If needed, <a href="Security.html#access">limit access to the TDS</a> and create a <code>robots.txt</code> file in <code>${tomcat_home}/webapps/ROOT/</code> to restrict crawler activity.</li>
    </ol>
   </div>  <!-- end section -->



   <div id="section">
    <h2><a name="maintenance">Maintenance and Upgrades</a></h2>

    <h3>Maintenance</h3>
    <p><b>Be sure to periodically check to make sure you are running the <a href="Security.html#versions">latest versions</a> of Java, Tomcat and the TDS.</b></p>
    <ul>
     <li>If you have enabled <a href="TDSMonitoringAndDebugging.html">access logging</a> (and you should), zip up the unused access logs in <code>${tomcat_home}/logs/</code> and archive them off to another directory.</li>
     <li>Likewise, zip up the unused TDS servlet logs in <code>${tomcat_home}/content/thredds/logs</code> and archive them as well.</li>
    </ul>

    <h3>Upgrading the TDS</h3>

    <p>When installing a new <code>thredds.war</code>, everything in <code>${tomcat_home}/webapps/</code> is overwritten. However, nothing  in <code>${tomcat_home}/content/</code> is overwritten.</p>
    <p>Use one of the following methods to deploying a new version of the TDS</p>
    <ul>
     <li><a href="GettingStarted.html#deployViaManager">Tomcat <code>manager</code> application</a></li>    
     <li><a href="GettingStarted.html#deploying">manual installation</a></li>  
    </ul>
   </div> <!-- end section -->
  </body>
 </html>   
