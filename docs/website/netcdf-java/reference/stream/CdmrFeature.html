<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>CDM Remote Feature For Grid (Coverage)</title>
<link rel="stylesheet" href="./../../cdm.css">
</head>
<body class="article">
<div id="header">
<h1>CDM Remote Feature For Grid (Coverage)</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>CDM Remote is a web service implemented in the CDM library (client) and TDS (server), providing remote access to CDM feature datasets, using
<a href="NcStream.html">ncstream</a> as the on-the-wire protocol. It provides access at the NetcdfFile and FeatureDataset levels of the CDM API, so there are
two levels of services:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong><a href="CdmRemote.html">CdmRemote</a></strong> provides index subsetting on remote CDM datasets, with the same functionality that <strong>NetcdfFile</strong> provides for
CDM local datasets and <strong>DODSNetcdfFile</strong> provides for remote OPeNDAP datasets. CdmRemote supports the full CDM data model.</p>
</li>
<li>
<p><strong>CdmrFeature</strong> provides coordinate subsetting on remote CDM Feature Datasets, with similar functionality to WCS and
Unidata&#8217;s <a href="../../../tds/reference/services/NetcdfSubsetServiceReference.html"><em>NetCDF Subset Service</em></a> <em>(NCSS)</em>. This API and protocol is redone
in version 5.0.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The CDM Remote services and protocol are experimental and should not be used outside of the CDM stack for now.</p>
</div>
<hr>
<div class="paragraph">
<p>The client creates requests of the form <strong>endpoint?query</strong>, where <em>endpoint</em> is the URL of a CdmrFeature service, and <em>query</em> is one or more <strong><em>key=value</em></strong> parameters, as described below.</p>
</div>
<div class="paragraph">
<p>Example request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>http://thredds-dev.unidata.ucar.edu/thredds/cdmrfeature/grid/grib/NCEP/GFS/Global_0p5deg/Best?req=data&amp;var=Albedo_surface_Mixed_intervals_Average</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="CdmrfGrammer.adoc">CdmrFeature Grammer</a> for a description of the on-the-wire protocol.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subsetting_parameters_for_grid_coverage_datasets">Subsetting Parameters for Grid (Coverage) Datasets:</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 10%;">
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter Name</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description / possible values</th>
<th class="tableblock halign-left valign-top">Constraints</th>
<th class="tableblock halign-left valign-top">default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>var</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name(s) of variables (comma separated, no blanks), or <em>all</em>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variables must be in the dataset description.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>north, south, east, west</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lat/lon bounding box, units of degrees_east, degrees_north</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">south &lt; north, west &lt; east; if crossing 180 meridian, use east boundary &gt; 180</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>minx, miny, maxx, maxy</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Projection bounding box, in projection coordinate units (km)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">min &lt; max</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>horizStride</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Take only every nth point (both x and y)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>time</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time as a <a href="http://www.unidata.ucar.edu/software/thredds/v5.0/tds/reference/services/NetcdfSubsetServiceReference.html#W3Cdate">W3C date</a> or <em>present</em> (the time slice closest to the requested time is returned) or <em>all</em> (all times are returned)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Must be a time within the dataset time range</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>present</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>time_start, time_end, time_duration</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to specify a time range (two of these must be present). Times may be a <a href="#W3Cdate">W3C date</a> or <em>present</em>. Duration is a udunit time or <a href="http://www.unidata.ucar.edu/software/thredds/v5.0/tds/reference/services/NetcdfSubsetServiceReference.html#W3Cduration">W3C time duration</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The requested time range must intersect the dataset time range</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>timeStride</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Take only every nth time in the available series</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used with time_range or <em>all</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>runtime</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time as a <a href="http://www.unidata.ucar.edu/software/thredds/v5.0/tds/reference/services/NetcdfSubsetServiceReference.html#W3Cdate">W3C date</a> or <em>latest</em> (restrict to that runtime) or <em>all</em>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used only if there is an independent runtime coordinate.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>latest</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>timeOffset</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Restrict to an offset from the runtime coordinate (must use same timeOffset units as the dataset), or <em>first</em> or <em>all</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used only if there is a 2D time coordinate (runtime and forecast time)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vertCoord</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Restrict to specified vertical level coordinate value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used only if there is a vertical coordinate.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ensCoord</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Restrict to specified ensemble coordinate.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used only if there is an ensemble coordinate.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Variable subsetting</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>You <strong>must</strong> specify a list of valid variable names, or "<em>all</em>".</p>
</li>
<li>
<p>variable names are case-sensitive and must be URL encoded. Be careful not to URL encode twice.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Horizontal spatial subsetting</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>You may specify a lat/lon bounding box or, if the dataset is on a projection, a projection bounding box. If none, return the entire horizontal grid.</p>
</li>
<li>
<p>Lat/lon bounds start at the west value and includes the area going east, until the east value.</p>
</li>
<li>
<p>Best practice is to make east &gt; west longitude, by adding 360 to it if needed.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Vertical spatial subsetting</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>You may specify a vertical coordinate. The closest level is returned. If not specified, all vertical levels are returned.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Temporal subsetting</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>These rules apply to non-2D time datasets.</p>
</li>
<li>
<p>You may specify a time range, or a time point. If both, only the time point is used. If neither, use the present time.</p>
</li>
<li>
<p>A time range (<em>time_start, time_end, time_duration</em>) will request all times that intersect the range (<em>timeStride</em> is used if present).</p>
</li>
<li>
<p>Two of <em>time_start, time_end, time_duration</em> must be present to define a valid time range. <em>time_start, time_end</em> may equal <em>present</em>.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><em>time_start, time_end</em> : specified range</p>
</li>
<li>
<p><em>time_start, time_duration</em> : starting from <em>time_start</em> until <em>time_start + time_duration</em></p>
</li>
<li>
<p><em>time_end, time_duration</em> : starting from <em>time_end - time_duration</em> until <em>time_end</em></p>
</li>
</ol>
</div>
</li>
<li>
<p>A time point will request the time that is closest to that value.</p>
</li>
<li>
<p>If you set <em>time="all"</em>, then all times are returned (<em>timeStride</em> is used if present). All other time parameters are ignored.</p>
</li>
<li>
<p>time duration: 1) udunit time unit string or 2) <a href="http://www.unidata.ucar.edu/software/thredds/v5.0/tds/reference/services/NetcdfSubsetServiceReference.html#W3Cduration">W3C time duration</a></p>
</li>
<li>
<p>datetime: <a href="http://www.unidata.ucar.edu/software/thredds/v5.0/tds/reference/services/NetcdfSubsetServiceReference.html#W3Cdate">W3C date</a> or <em>present</em></p>
</li>
<li>
<p>The dataset determines what Calendar is used, so you must use that calendar. There can only be one calendar per dataset.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">2D Time subsetting</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>A 2D time dataset will have CoverageType set to <em>FMRC</em>.</p>
</li>
<li>
<p>You may specify a runtime with a date, <em>latest</em> or <em>all</em>; specify a timeOffset with a numeric value, <em>first</em>, or <em>all</em>.
If only one is set, use the default for the other. If neither is set, then return all times for latest runtime.</p>
</li>
<li>
<p>Time parameters are only used if explicitly set and timeOffset is not set. There are only 2 cases where time can be used:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set runtime to a specific value or <em>latest</em> (not <em>all</em>). Time parameters (point or range) can be used.</p>
</li>
<li>
<p>Set runtime to <em>all</em>. Time point (date, or <em>present</em>) can be used.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Special cases:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>set specific runtime = constant runtime dataset</p>
</li>
<li>
<p>set specific timeOffset, set runTime to <em>all</em> = constant offset dataset</p>
</li>
<li>
<p>set specific time, set runTime to <em>all</em> = constant forecast dataset</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Interval coordinate</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>If the coordinate is an <em>interval coordinate</em> (common for vertical or time coordinates), it has a lower and upper bound, eg (2.0-10.0 m) or (12-24 hours).</p>
</li>
<li>
<p>The request is still made with a single value. The interval that contains the requested value is used.</p>
</li>
<li>
<p>If the requested value is contained in more than one interval (happens with mixed interval time coordinates), the midpoint of the interval is calculated, and the closest midpoint to the requested
value is used.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<hr>
<div class="paragraph">
<p><span class="image"><img src="../../nc.gif" alt="image"></span> This document was last updated August 2015</p>
</div>
<div class="literalblock">
<div class="content">
<pre> </pre>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-09-04 09:42:33 MDT
</div>
</div>
</body>
</html>