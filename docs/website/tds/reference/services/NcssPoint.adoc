= NCSS For Point Data
:linkcss:
:stylesheet: ../../tds.css
:cdmDocs: ../../../netcdf-java/reference/
:toc:

== Subsetting Parameters for NCSS Point

These parameters are identical to the CdmrFeature service:

include::{cdmDocs}stream/CdmrCoverageParams.adoc[]

In addition, NCSS supports these parameters for Points:

[width="100%",cols="20%,10%,30%,30%,10%",options="header",]
|====
| Parameter Name | Required  | Description  | Constraints | default
| *latitude, longitude* | no | Point location. units of degrees_east, degrees_north | Must be within the dataset bounding box |
| *stns* | no | Specify the list of stations in the subset. | Only on station datasets. |
| *accept* | no | The returned data format. | _netCDF_, _netCDF4_, _XML_, _CSV_, _WaterML2_ | _CSV_
|====

Variable subsetting::

* For all types, you *must* specify a list of valid variable names.

Horizontal spatial subsetting::

* stations: you may specify (in order of precedence): 1) a list of stations, 2) a point location, or 3) a lat/lon bounding box. If none, use all.
* points: you may specify a lat/lon bounding box. If none, use all.
* Note the lat/lon bounding box declared in the dataset description is an approximated rectangle to the actual lat/lon boundaries so there may be
  valid points within the data but outside of the declared bounding box in the dataset description

Temporal subsetting::

* For all types, you may specify a time range or a specific time. If none, return the time closest to the present.
* A time range will request all features that intersect the range.
* A time point will request the feature that is closest to that time.
* If you include _time=all_, then return all times.

Output Format (__accept__ parameter)::

* __csv__: Comma-separated values, one feature per line
* __xml__: Collection of feature elements
* __netCDF__: CF/NetCDF-3
* __netCDF4__: CF/NetCDF-4 classic model
* __netCDF4ext__: NetCDF-4 extended model
* __WaterML2__: http://www.opengeospatial.org/standards/waterml[OGC WaterML 2.0 Timeseries] (station only)

== *Spatial and coordinate subsetting*

=== *Lat/lon bounding box*

Specified with the params _north, south, east_ and _west._ The _north_ and _south_ parameters are latitude values, and must
be in units of _degrees_north_ and lie between +/- 90. The _east_ and _west_ parameters are longitude values with units of __degrees_east__, and may
be positive or negative, and will be interpreted modulo 360. The requested subset starts at the west longitude and goes eastward until the east
longitude. Therefore, when crossing the dateline, the west edge may be greater than the east edge. For grids, if the underlying dataset is on a
projection, the minimum enclosing projection bounding box will be calculated and used. The data contained in the intersection of this rectangle with
the data is returned. To use, inspect _dataset.xml_ for the <LatLonBox> elements, which indicate the min and max extensions of the grid, for
example:

[source,xml]
----
<LatLonBox>
  <west>-153.5889</west>
  <east>-48.5984</east>
  <south>11.7476</south>
  <north>57.4843</north>
</LatLonBox>
----

Example request:

 &north=17.3&south=12.088&west=140.2&east=160.0

=== *Station list*


=== *Single-point requests*

The NetCDF Subset Service allows the user to extract data for a point of interest by specifying its latitude and longitude. The result differs
depending on the underlying dataset.

* If it's a station dataset, NCSS will return data for the station nearest the specified lat/lon. The supported output formats are
_netCDF_, _netCDF4_, _XML_, _CSV_  and _WaterML2_.
* Point datasets do not support single-point requests. (LOOK is that true?)

For example:

--------------------------------------------------
?req=station&var=temp&latitude=40.2&longitude=61.8
--------------------------------------------------

This finds the station nearest to (lat=40.2, lon=61.8) and returns its temperature data.

== *Temporal subsetting*

There are several ways to do temporal subsetting requests:

* Default: If no temporal subseting is specified, the closest time to the current time is returned.
* All time range: A shorthand to request all the time range in a dataset is setting the parameter _time=all_. This can also be done by providing a
valid temporal range containing the entire dataset time range.
* One single time: Passing the parameter time will get the time slice closest to the requested time if it is within the time range of the dataset.
* Valid time range: A valid time range is defined with two of the three parameters: time_start, time_end and time_duration.

Times (time, time_start and time_end) must be specified as link:#W3Cdate[W3C date string] or "present" and time_duration as a link:#W3Cduration[W3C
time duration]

Examples of time query strings with valid temporal ranges:

----
 *time_start=2007-03-29T12:00:00Z&time_end=2007-03-29T13:00:00Z* (between 12 and 1 pm Greenwich time)
 *time_start=present&time_duration=P3D* (get 3 day forecast starting from the present)
 *time_end=present&time_duration=PT3H* (get last 3 hours)
 *time=2007-03-29T12:00:00Z*
 *time=present*
 *time=all*
----

Examples:
[width="100%",cols="60%,40%",options="header",]
|====
| Request |Query string
| _All of the data for the variable Temperature_pressure for the closest time to the current time_ | *?var=Temperature_pressure&temporal=all*
| _All of the data for the variable Temperature_pressure available in a given time range_ | *?var=Temperature_pressure&time_start=2015-08-19Z&time_end=2015-08-20T12:00:00Z*
| _All of the data for the variable Temperature_pressure for a specific time_ | *?var=Temperature_pressure&time=2015-09-06T00:00:00Z*
| _Subset the data for the variable Temperature_pressure over a given lat/lon bounding box for a specific time_ | *?var=Temperature_pressure&time=2015-09-06T00:00:00Z&north=41&west=-109.05&east=-102.05&south=37*
| _Temperature_pressure for every 5th point on the grid (deltax=deltay=5)_ | *?var=Temperature_pressure&horizStride=5*
| _Temperature_pressure for every 5th point on the grid over a given lat/lon bounding box_ |*?var=Temperature_pressure&north=41&west=-109.5&east=-102.5&south=37&horizStride=5*
| _Temperature_pressure at a particular vertical level: 1000 mb_ | *?var=Temperature_pressure&vertCoord=1000*
| _Air_temperature for stations named LECO, LEST and LEVX_ | *?var=air_temperature&subset=stns&stns=LECO,LEST,LEVX*
|====

'''''

image:../../images/thread.png[image]This document was last updated September 2015
