dependencies {
    testCompile project(":cdm")
    testRuntime project(":clcommon")
    testRuntime project(":grib")
    testCompile project(":httpservices")
    testRuntime project(":opendap")
    testRuntime project(":visad")
    testCompile project(path: ':cdm', configuration: 'testArtifacts')

    testRuntime libraries["jaxen"]
    testCompile libraries["jdom2"]
    testCompile libraries["commons-io"]
    testCompile libraries["joda-time"]
    testCompile libraries["httpcore"]
    testCompile libraries["httpclient"]

    testCompile libraries["com.eclipsesource.restfuse"]

    testRuntime libraries["slf4j-jdk14"]
}


buildscript {
    dependencies {
        classpath libraries["gretty"]
    }
}

apply plugin: 'org.akhikhl.gretty'

gretty {
    servletContainer = 'tomcat7'
    httpPort = 8081
    contextPath = '/thredds'

    // Overlay the "tds" webapp onto this project's webapp.
    // This is how we're able to have tds integration tests outside of the tds project.
    // See http://akhikhl.github.io/gretty-doc/Web-app-overlays.html
    overlay ':tds'

    integrationTestTask = 'integrationTest' // The name of an existing gradle task.

    def contentRoot = 'C:\\Users\\cwardgar\\dev\\tools\\apache-tomcat-8.0.12\\content'
    systemProperty 'tds.content.root.path', contentRoot
}

// Gretty will start the webapp before this task and shut it down afterward.
task integrationTest(type: Test, dependsOn: 'test') {
    include 'thredds/server/catalog/TestTdsLocal.class'
}
